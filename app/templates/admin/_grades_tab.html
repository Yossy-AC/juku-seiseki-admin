<div class="grades-tab">
    <h2>成績入力</h2>

    <form hx-post="/api/grades"
          hx-target="#recent-grades-table"
          hx-swap="innerHTML"
          style="background: white; padding: 1.5rem; border-radius: 8px; margin-bottom: 2rem;">

        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
            <!-- 講座選択 -->
            <div class="form-group">
                <label>講座を選択</label>
                <select name="class_id" required
                        hx-get="/api/classes//students"
                        hx-trigger="change"
                        hx-target="#student-select-container"
                        style="width: 100%; padding: 0.75rem; border: 1px solid #ddd; border-radius: 4px;"
                        onchange="this.setAttribute('hx-get', '/api/classes/' + this.value + '/students')">
                    <option value="">選択してください</option>
                    <option value="c001">高3英語@難関大</option>
                    <option value="c002">高2数学基礎</option>
                    <option value="c003">高3物理</option>
                </select>
            </div>

            <!-- 生徒選択（連鎖） -->
            <div class="form-group">
                <label>生徒を選択</label>
                <div id="student-select-container">
                    <select name="student_id" required disabled style="width: 100%; padding: 0.75rem; border: 1px solid #ddd; border-radius: 4px;">
                        <option value="">講座を選択してから選んでください</option>
                    </select>
                </div>
            </div>
        </div>

        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
            <!-- テスト日 -->
            <div class="form-group">
                <label>テスト日</label>
                <input type="date" name="date" required style="width: 100%; padding: 0.75rem; border: 1px solid #ddd; border-radius: 4px;">
            </div>

            <!-- 授業内容 -->
            <div class="form-group">
                <label>授業内容</label>
                <input type="text" name="lesson_content" placeholder="例: Unit 5 Grammar" style="width: 100%; padding: 0.75rem; border: 1px solid #ddd; border-radius: 4px;">
            </div>
        </div>

        <h3 style="margin-top: 1.5rem; margin-bottom: 1rem; color: #333;">各セクションの得点</h3>

        <div style="display: grid; grid-template-columns: repeat(5, 1fr); gap: 1rem;">
            <div class="form-group">
                <label>理解（0-20）</label>
                <input type="number" name="score_comprehension" min="0" max="20" required style="width: 100%; padding: 0.75rem; border: 1px solid #ddd; border-radius: 4px;">
            </div>
            <div class="form-group">
                <label>初見（0-20）</label>
                <input type="number" name="score_unseen" min="0" max="20" required style="width: 100%; padding: 0.75rem; border: 1px solid #ddd; border-radius: 4px;">
            </div>
            <div class="form-group">
                <label>文法（0-20）</label>
                <input type="number" name="score_grammar" min="0" max="20" required style="width: 100%; padding: 0.75rem; border: 1px solid #ddd; border-radius: 4px;">
            </div>
            <div class="form-group">
                <label>単語（0-20）</label>
                <input type="number" name="score_vocabulary" min="0" max="20" required style="width: 100%; padding: 0.75rem; border: 1px solid #ddd; border-radius: 4px;">
            </div>
            <div class="form-group">
                <label>リスニング（0-20）</label>
                <input type="number" name="score_listening" min="0" max="20" required style="width: 100%; padding: 0.75rem; border: 1px solid #ddd; border-radius: 4px;">
            </div>
        </div>

        <button type="submit" class="btn btn-primary" style="margin-top: 1.5rem; padding: 0.75rem 1.5rem;">成績を保存</button>
    </form>

    <h3>最近の成績入力</h3>
    <div id="recent-grades-table" hx-get="/api/grades?limit=5" hx-trigger="load">
        <p style="color: #999;">データを読み込み中...</p>
    </div>
</div>
